<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>// -=Global Declarations=-
// Sensor Values
const int CLEAR   = 75;
const int BLOCKED = 70;
const int YELLOW  = 60;
const int BLACK   = 48;

const int total_duration = 133;  //currently total duration is equal to the value Done

// Bags
const int NUM_BAGS=2;
typedef int[0, NUM_BAGS-1] t_id;

// FeedBelt Sensors
int fb0_Sensor = 75;
int fb1_Sensor = 75;
int Sensor[2] = {CLEAR, CLEAR};

// Place global declarations here.
const int speed_belt =20;

// Motor and Conveyor Belt
bool fwd; //direction of the distribution belt
bool dis_on; //is the distribution belt on or off
bool feed_on[2]; //array of the boolean for each of the feed belts

// Collision Sections. 
// Section C and D for both Feeding Belts
int collision[2];

// Counters
int BagsOnFeed[2];
int BagsInSystem;
int Delivered[2];
int FaultyDelivery[2];

// Channels
chan dis_start, dis_stop, dis_forward, dis_back; // chanels to start, stop and change direction of the distribution belt
chan feed_off_[2], feed_on_[2] ;                 //chanels to start and stop the two feed belts


chan Init, checkin0, checkin1, colorT, colorF;   //used by the user to set the bags on the feed
chan Sensor_[2];

urgent chan go[2];
urgent chan stop_feed[2];
urgent chan feed[2];
urgent chan returnStop[2];
urgent chan continue_feed[2];

// Feed Belt Timing Delays and durations
// -SENSOR-
const int pre_sensor_delay = 40/20;        // pre stable Sensor Reading
const int post_sensor_delay = 40/20;       // post stable Sensor Reading
const int active_sensor_time = (240)/20;   // Active Sensor Area
const int post_sensor_time = 40/20;        // Time before pause section B 

// -Section B-
const int pre_stop = 480/20;                // after sensor before queue | pause placement in Section B

const int motor_stop = active_sensor_time+post_sensor_delay+pre_stop-1;


//int sensor_section_1 = 40/20;
//int sensor_section_main = (40+ 240)/20; 
//int sensor_section_3 = (40 + 240 +40) /20;
//int belt_c_min =24; 
//int b = 480/20;
int c_min = 24;
int c_max = 27;
int d_min = 22;
int d_max = 23;
int e_min = 10;
int e_max = 12;
int f_min = 25;
int f_max = 31;


//chan do_c, do_e;
//chan fwd_sync, fwd_sync_n;</declaration>
	<template>
		<name>FeedBelt_Controller</name>
		<parameter>const int[0,1] belt</parameter>
		<declaration>int now =0;
int done = 40;
clock x;
//clock now;
bool destA;
bool closeToA;
bool sensorActive;
</declaration>
		<location id="id0" x="-510" y="-391">
			<label kind="comments" x="-680" y="-408">INITIAL CONDITION
TURN ON FEEDBELT</label>
			<committed/>
		</location>
		<location id="id1" x="-509" y="-306">
		</location>
		<location id="id2" x="-476" y="136">
			<committed/>
		</location>
		<location id="id3" x="-510" y="-195">
			<label kind="invariant" x="-493" y="-204">x&lt;=pre_sensor_delay</label>
		</location>
		<location id="id4" x="-510" y="-93">
			<label kind="invariant" x="-493" y="-101">x&lt;=motor_stop</label>
		</location>
		<location id="id5" x="-340" y="34">
			<label kind="invariant" x="-350" y="51">x &lt;= done - now</label>
		</location>
		<location id="id6" x="-510" y="-34">
			<urgent/>
		</location>
		<location id="id7" x="-960" y="153">
			<committed/>
		</location>
		<location id="id8" x="-654" y="-272">
			<name x="-664" y="-306">End_of_feed_belt</name>
			<committed/>
		</location>
		<location id="id9" x="-646" y="34">
			<label kind="invariant" x="-646" y="42">x &lt;= 1</label>
		</location>
		<location id="id10" x="-722" y="255">
			<committed/>
		</location>
		<location id="id11" x="-722" y="119">
			<committed/>
		</location>
		<init ref="id0"/>
		<transition>
			<source ref="id9"/>
			<target ref="id10"/>
			<label kind="guard" x="-714" y="153">destA</label>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id11"/>
			<label kind="guard" x="-704" y="42">not destA</label>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id7"/>
			<label kind="guard" x="-832" y="102">!closeToA</label>
			<nail x="-790" y="119"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id7"/>
			<label kind="guard" x="-841" y="136">closeToA</label>
			<label kind="assignment" x="-858" y="153">done = done+69</label>
			<nail x="-790" y="153"/>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id7"/>
			<label kind="guard" x="-832" y="195">!closeToA</label>
			<label kind="assignment" x="-917" y="255">done = done + 69</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id7"/>
			<label kind="guard" x="-917" y="238">closeToA</label>
			<nail x="-960" y="255"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id1"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id8"/>
			<label kind="assignment" x="-926" y="-153">x:=0, 
done:= done+ 69</label>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id10"/>
			<label kind="guard" x="-594" y="187">destA</label>
			<label kind="synchronisation" x="-586" y="204">dis_forward!</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id6"/>
			<label kind="guard" x="-501" y="-84">x==motor_stop</label>
		</transition>
		<transition>
			<source ref="id1"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-501" y="-289">go[belt]?</label>
			<label kind="assignment" x="-502" y="-272">sensorActive=true,
x:=0</label>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id11"/>
			<label kind="guard" x="-578" y="93">not destA</label>
			<label kind="synchronisation" x="-578" y="110">dis_back!</label>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id2"/>
			<label kind="guard" x="-331" y="68">x &gt;= done - now</label>
			<label kind="synchronisation" x="-331" y="85">dis_stop!</label>
			<label kind="assignment" x="-331" y="110">feed_on[belt] = true, done:=0, now := 0</label>
		</transition>
		<transition>
			<source ref="id0"/>
			<target ref="id1"/>
			<label kind="assignment" x="-501" y="-374">feed_on[belt]:= true, 
closeToA = (belt ==0), 
now:= 0, done :=40</label>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id4"/>
			<label kind="guard" x="-501" y="-178">x == pre_sensor_delay</label>
			<label kind="synchronisation" x="-501" y="-161">Sensor_[belt]?</label>
			<label kind="assignment" x="-501" y="-144">destA=(Sensor[belt]==BLACK),
x:=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id9"/>
			<label kind="guard" x="-637" y="-42">destA==fwd</label>
			<label kind="assignment" x="-637" y="-25">feed_on[belt]:=true, 
x:=0, done:=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id5"/>
			<label kind="guard" x="-459" y="-42">destA!=fwd</label>
			<label kind="assignment" x="-459" y="-25">feed_on[belt]:=false, 
now := now +40, x:=0</label>
		</transition>
	</template>
	<template>
		<name>Template0</name>
		<parameter>const int[0,1] belt</parameter>
		<location id="id12" x="0" y="0">
		</location>
		<init ref="id12"/>
		<transition>
			<source ref="id12"/>
			<target ref="id12"/>
			<label kind="synchronisation" x="93" y="-8">returnStop[belt]!</label>
			<nail x="85" y="-34"/>
			<nail x="85" y="42"/>
		</transition>
	</template>
	<template>
		<name>Controller</name>
		<declaration>const int [0,1] belt_active =1;
</declaration>
		<location id="id13" x="-1972" y="-1224">
		</location>
		<location id="id14" x="-1802" y="-1224">
		</location>
		<location id="id15" x="-1496" y="-1113">
		</location>
		<init ref="id13"/>
		<transition>
			<source ref="id15"/>
			<target ref="id14"/>
			<nail x="-1717" y="-1113"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id15"/>
			<nail x="-1598" y="-1224"/>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id14"/>
			<label kind="synchronisation" x="-1929" y="-1249">dis_start!</label>
			<label kind="assignment" x="-1929" y="-1224">fwd:=true,
dis_on:=true</label>
		</transition>
	</template>
	<template>
		<name>FeedBelt_motor</name>
		<parameter>const int[0,1] belt</parameter>
		<location id="id16" x="34" y="9">
			<committed/>
		</location>
		<location id="id17" x="34" y="136">
			<name x="42" y="102">Belt_on</name>
		</location>
		<location id="id18" x="-136" y="136">
			<name x="-187" y="102">Belt_off</name>
		</location>
		<init ref="id16"/>
		<transition>
			<source ref="id18"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="-110" y="169">feed_on_[belt]?</label>
			<label kind="assignment" x="-110" y="186">feed_on[belt]:= true</label>
			<nail x="-101" y="169"/>
			<nail x="0" y="170"/>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-297" y="136">feed_off_[belt]?</label>
			<nail x="-195" y="178"/>
			<nail x="-195" y="136"/>
			<nail x="-153" y="136"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-110" y="59">feed_off_[belt]?</label>
			<label kind="assignment" x="-111" y="75">feed_on[belt]:= false</label>
			<nail x="0" y="102"/>
			<nail x="-101" y="102"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="101" y="137">feed_on_[belt]?</label>
			<nail x="93" y="179"/>
			<nail x="93" y="136"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id17"/>
			<label kind="assignment" x="42" y="34">feed_on[belt]:= true</label>
		</transition>
	</template>
	<template>
		<name>Controler_monkey</name>
		<declaration>const int [0,1] belt0 =1;
const int [0,1] belt1 =0;</declaration>
		<location id="id19" x="0" y="-34">
		</location>
		<init ref="id19"/>
		<transition>
			<source ref="id19"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="110" y="8">dis_forward!</label>
			<nail x="102" y="34"/>
			<nail x="102" y="-1"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="59" y="34">dis_back!</label>
			<nail x="51" y="34"/>
			<nail x="85" y="34"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="-17" y="34">dis_stop!</label>
			<nail x="-17" y="34"/>
			<nail x="17" y="34"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="119" y="-76">dis_start!</label>
			<nail x="102" y="-34"/>
			<nail x="102" y="-68"/>
		</transition>
	</template>
	<template>
		<name>Bag</name>
		<parameter>t_id bag_id</parameter>
		<declaration>// -=Variable Declarations=-
int feedBelt;
int color;
clock x_bag;    //Aggregate for bag travel time
clock x;        //per element clock
//clock temp_c;



</declaration>
		<location id="id20" x="-272" y="-501">
			<name x="-314" y="-526">initial</name>
		</location>
		<location id="id21" x="272" y="476">
			<name x="289" y="442">Destination_B</name>
			<label kind="comments" x="289" y="417">Bags: YELLOW</label>
			<committed/>
		</location>
		<location id="id22" x="-34" y="-280">
			<label kind="comments" x="-136" y="-305">FEEDBELT 1</label>
			<urgent/>
		</location>
		<location id="id23" x="-841" y="476">
			<name x="-943" y="442">Destination_A</name>
			<label kind="comments" x="-943" y="408">Bags: BLACK</label>
			<committed/>
		</location>
		<location id="id24" x="-272" y="-442">
		</location>
		<location id="id25" x="-272" y="-357">
			<name x="-282" y="-391">Initalized</name>
			<committed/>
		</location>
		<location id="id26" x="-510" y="-280">
			<label kind="comments" x="-612" y="-305">FEEDBELT 0</label>
			<urgent/>
		</location>
		<location id="id27" x="-510" y="170" color="#ffc0cb">
			<name x="-578" y="144">fb0_stop</name>
			<urgent/>
		</location>
		<location id="id28" x="-714" y="476" color="#ffa500">
			<name x="-697" y="442">e1</name>
			<label kind="invariant" x="-671" y="450">x &lt;= e_max</label>
		</location>
		<location id="id29" x="170" y="476" color="#ffa500">
			<name x="162" y="442">e2</name>
			<label kind="invariant" x="187" y="450">x &lt;= e_max</label>
		</location>
		<location id="id30" x="-510" y="340" color="#00ff00">
			<name x="-535" y="314">c1</name>
			<label kind="invariant" x="-484" y="323">x &lt;= c_max</label>
		</location>
		<location id="id31" x="-272" y="476" color="#ff00ff">
			<name x="-281" y="433">f_section</name>
			<label kind="invariant" x="-247" y="459">x &lt;= f_max</label>
		</location>
		<location id="id32" x="-34" y="340" color="#00ff00">
			<name x="-59" y="315">c2</name>
			<label kind="invariant" x="-17" y="332">x &lt;= c_max</label>
		</location>
		<location id="id33" x="-510" y="476" color="#ffff00">
			<name x="-493" y="442">d1</name>
			<label kind="invariant" x="-501" y="450">x &lt;= d_max</label>
		</location>
		<location id="id34" x="-34" y="476" color="#ffff00">
			<name x="-34" y="442">d2</name>
			<label kind="invariant" x="-17" y="450">x &lt;= d_max</label>
		</location>
		<location id="id35" x="-510" y="-178" color="#00ffff">
			<name x="-629" y="-204">fb0_pre_sensor</name>
			<label kind="invariant" x="-484" y="-187">x &lt;= pre_sensor_delay</label>
			<label kind="comments" x="-637" y="-221">SECTION A: Cyan</label>
		</location>
		<location id="id36" x="-510" y="-85" color="#00ffff">
			<name x="-603" y="-110">fb0_sensor</name>
			<label kind="invariant" x="-484" y="-93">x &lt;= active_sensor_time</label>
		</location>
		<location id="id37" x="-510" y="0" color="#00ffff">
			<name x="-629" y="-25">fb0_post_sensor</name>
			<label kind="invariant" x="-484" y="-9">x &lt;= post_sensor_delay</label>
		</location>
		<location id="id38" x="-510" y="85" color="#ffc0cb">
			<name x="-612" y="60">fb0_pre_stop</name>
			<label kind="invariant" x="-484" y="77">x &lt;= pre_stop</label>
			<label kind="comments" x="-637" y="43">SECTION B: Pink</label>
		</location>
		<location id="id39" x="-34" y="85" color="#ffc0cb">
			<name x="-136" y="60">fb1_pre_stop</name>
			<label kind="invariant" x="-8" y="77">x &lt;= pre_stop</label>
			<label kind="comments" x="-161" y="43">SECTION B: Pink</label>
		</location>
		<location id="id40" x="-34" y="170" color="#ffc0cb">
			<name x="-102" y="136">fb1_stop</name>
			<urgent/>
		</location>
		<location id="id41" x="-34" y="0" color="#00ffff">
			<name x="-153" y="-33">fb1_post_sensor</name>
			<label kind="invariant" x="-8" y="-8">x &lt;= post_sensor_delay</label>
		</location>
		<location id="id42" x="-34" y="-178" color="#00ffff">
			<name x="-153" y="-204">fb1_pre_sensor</name>
			<label kind="invariant" x="-8" y="-187">x &lt;= pre_sensor_delay</label>
			<label kind="comments" x="-161" y="-221">SECTION A: Cyan</label>
		</location>
		<location id="id43" x="-34" y="-85" color="#00ffff">
			<name x="-127" y="-110">fb1_sensor</name>
			<label kind="invariant" x="-8" y="-93">x &lt;= active_sensor_time</label>
		</location>
		<location id="id44" x="-272" y="-552">
			<name x="-263" y="-586">Finish</name>
			<committed/>
		</location>
		<location id="id45" x="-340" y="204">
			<name x="-350" y="170">fb0_stopped</name>
		</location>
		<location id="id46" x="136" y="204">
			<name x="126" y="170">fb1_stopped</name>
		</location>
		<init ref="id20"/>
		<transition>
			<source ref="id30"/>
			<target ref="id28"/>
			<label kind="guard" x="-646" y="348">fwd and x &gt;= c_min</label>
			<label kind="assignment" x="-646" y="365">x:=0,
collision[0]--</label>
		</transition>
		<transition>
			<source ref="id46"/>
			<target ref="id40"/>
			<label kind="guard" x="8" y="187">feed_on[1]</label>
			<label kind="synchronisation" x="0" y="204">returnStop[feedBelt]?</label>
			<nail x="0" y="204"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id46"/>
			<label kind="guard" x="8" y="145">not feed_on[1]</label>
			<nail x="102" y="170"/>
		</transition>
		<transition>
			<source ref="id45"/>
			<target ref="id27"/>
			<label kind="guard" x="-467" y="187">feed_on[0]</label>
			<label kind="synchronisation" x="-476" y="204">returnStop[feedBelt]?</label>
			<nail x="-476" y="204"/>
		</transition>
		<transition>
			<source ref="id44"/>
			<target ref="id20"/>
			<label kind="assignment" x="-272" y="-526">BagsInSystem--</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id44"/>
			<nail x="195" y="-527"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id44"/>
			<nail x="-714" y="-527"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id32"/>
			<label kind="guard" x="-25" y="238">dis_on and feed_on[1]</label>
			<label kind="assignment" x="-25" y="255">x:=0,
BagsOnFeed[1]--,
collision[1]++</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id42"/>
			<label kind="guard" x="-25" y="-272">feed_on[1]</label>
			<label kind="synchronisation" x="-25" y="-255">go[feedBelt]!</label>
			<label kind="assignment" x="-25" y="-238">Sensor[1]:=BLOCKED,
x:=0</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id30"/>
			<label kind="guard" x="-501" y="229">dis_on and feed_on[0]</label>
			<label kind="assignment" x="-501" y="255">x:=0,
BagsOnFeed[0]--,
collision[0]++</label>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id27"/>
			<label kind="guard" x="-501" y="102">x == pre_stop</label>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id38"/>
			<label kind="guard" x="-501" y="17">x==post_sensor_delay</label>
			<label kind="assignment" x="-501" y="34">x := 0,
fb0_Sensor := CLEAR</label>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id35"/>
			<label kind="guard" x="-501" y="-272">feed_on[0]</label>
			<label kind="synchronisation" x="-501" y="-255">go[feedBelt]!</label>
			<label kind="assignment" x="-501" y="-238">Sensor[0]:=BLOCKED,
x:=0</label>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id37"/>
			<label kind="guard" x="-501" y="-68">x==active_sensor_time</label>
			<label kind="assignment" x="-501" y="-51">fb0_Sensor := BLOCKED,
x:=0</label>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id36"/>
			<label kind="guard" x="-501" y="-170">x==pre_sensor_delay</label>
			<label kind="synchronisation" x="-501" y="-153">Sensor_[feedBelt]!</label>
			<label kind="assignment" x="-501" y="-136">Sensor[0] := color,
x:=0</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id45"/>
			<label kind="guard" x="-467" y="153">not feed_on[0]</label>
			<nail x="-374" y="170"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id21"/>
			<label kind="guard" x="178" y="484">not fwd and dis_on
and x &gt;= e_min</label>
			<label kind="assignment" x="178" y="518">x:= 0</label>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id29"/>
			<label kind="guard" x="-17" y="485">not fwd and dis_on
and x &gt;= d_min</label>
			<label kind="assignment" x="-17" y="519">x := 0</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id34"/>
			<label kind="guard" x="-221" y="485">not fwd and dis_on
and x &gt;= f_min</label>
			<label kind="assignment" x="-221" y="519">x := 0</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id33"/>
			<label kind="guard" x="-433" y="485">fwd and dis_on
and x &gt;= f_min</label>
			<label kind="assignment" x="-433" y="519">x :=0</label>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id28"/>
			<label kind="guard" x="-629" y="485">fwd and dis_on
and x &gt;= d_min</label>
			<label kind="assignment" x="-629" y="519">x :=0</label>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id23"/>
			<label kind="guard" x="-799" y="485">fwd and dis_on
and x &gt;= e_min</label>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id29"/>
			<label kind="guard" x="51" y="365">not fwd and x &lt;= c_max</label>
			<label kind="assignment" x="59" y="382">x:= 0,
collision[1]--</label>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id31"/>
			<label kind="guard" x="-229" y="365">fwd and x &gt;= c_min</label>
			<label kind="assignment" x="-161" y="382">x:=0,
collision[1]--</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id31"/>
			<label kind="guard" x="-433" y="365">not fwd and x &gt;= c_min</label>
			<label kind="assignment" x="-467" y="382">x :=0, 
collision[0]--</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id26"/>
			<label kind="synchronisation" x="-493" y="-382">checkin0?</label>
			<label kind="assignment" x="-493" y="-357">feedBelt = 0,
BagsOnFeed[0]++</label>
			<nail x="-510" y="-357"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id22"/>
			<label kind="synchronisation" x="-161" y="-382">checkin1?</label>
			<label kind="assignment" x="-161" y="-357">feedBelt = 1,
BagsOnFeed[1]++</label>
			<nail x="-34" y="-357"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id24"/>
			<label kind="synchronisation" x="-246" y="-484">Init?</label>
			<label kind="assignment" x="-246" y="-467">x_bag:= 0,
BagsInSystem++</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id25"/>
			<label kind="synchronisation" x="-238" y="-425">colorF?</label>
			<label kind="assignment" x="-238" y="-408">color = BLACK</label>
			<nail x="-238" y="-399"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id25"/>
			<label kind="synchronisation" x="-416" y="-425">colorT?</label>
			<label kind="assignment" x="-416" y="-409">color = YELLOW</label>
			<nail x="-306" y="-399"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id40"/>
			<label kind="guard" x="-25" y="102">x == pre_stop</label>
		</transition>
		<transition>
			<source ref="id41"/>
			<target ref="id39"/>
			<label kind="guard" x="-25" y="17">x==post_sensor_delay</label>
			<label kind="assignment" x="-25" y="34">x := 0,
fb1_Sensor := CLEAR</label>
		</transition>
		<transition>
			<source ref="id43"/>
			<target ref="id41"/>
			<label kind="guard" x="-25" y="-68">x==active_sensor_time</label>
			<label kind="assignment" x="-25" y="-51">fb1_Sensor := BLOCKED,
x:=0</label>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id43"/>
			<label kind="guard" x="-25" y="-170">x==pre_sensor_delay</label>
			<label kind="synchronisation" x="-25" y="-153">Sensor_[feedBelt]!</label>
			<label kind="assignment" x="-25" y="-136">Sensor[1] := color,
x:=0</label>
		</transition>
	</template>
	<template>
		<name>DisBelt_motor</name>
		<location id="id47" x="-170" y="-170">
			<committed/>
		</location>
		<location id="id48" x="8" y="51">
			<name x="-26" y="68">Dist_stop</name>
			<committed/>
		</location>
		<location id="id49" x="-170" y="-8">
			<name x="-238" y="-33">Forward</name>
		</location>
		<location id="id50" x="204" y="-8">
			<name x="221" y="-34">Back</name>
		</location>
		<init ref="id47"/>
		<transition>
			<source ref="id50"/>
			<target ref="id50"/>
			<label kind="synchronisation" x="297" y="0">dis_back?</label>
			<nail x="289" y="-8"/>
			<nail x="289" y="34"/>
		</transition>
		<transition>
			<source ref="id47"/>
			<target ref="id49"/>
			<label kind="assignment" x="-161" y="-119">dis_on := true,
fwd:=true</label>
		</transition>
		<transition>
			<source ref="id49"/>
			<target ref="id49"/>
			<label kind="synchronisation" x="-348" y="-17">dis_forward?</label>
			<nail x="-255" y="-8"/>
			<nail x="-255" y="34"/>
		</transition>
		<transition>
			<source ref="id50"/>
			<target ref="id48"/>
			<label kind="synchronisation" x="68" y="-51">dis_stop?</label>
			<label kind="assignment" x="67" y="-34">dis_on := false</label>
			<nail x="51" y="-8"/>
		</transition>
		<transition>
			<source ref="id49"/>
			<target ref="id48"/>
			<label kind="synchronisation" x="-119" y="-51">dis_stop?</label>
			<label kind="assignment" x="-119" y="-34">dis_on := false</label>
			<nail x="-25" y="-8"/>
		</transition>
		<transition>
			<source ref="id48"/>
			<target ref="id49"/>
			<label kind="synchronisation" x="-144" y="93">dis_forward?</label>
			<label kind="assignment" x="-144" y="111">fwd:= true,
dis_on:=true</label>
			<nail x="-144" y="93"/>
		</transition>
		<transition>
			<source ref="id48"/>
			<target ref="id50"/>
			<label kind="synchronisation" x="136" y="93">dis_back?</label>
			<label kind="assignment" x="136" y="110">fwd := false,
dis_on:=true</label>
			<nail x="170" y="93"/>
		</transition>
	</template>
	<template>
		<name>User</name>
		<location id="id51" x="807" y="-136">
			<name x="797" y="-170">BagCreated</name>
			<committed/>
		</location>
		<location id="id52" x="603" y="-136">
			<name x="535" y="-170">FeedBelt0</name>
			<committed/>
		</location>
		<location id="id53" x="1011" y="-136">
			<name x="1019" y="-161">FeedBelt1</name>
			<committed/>
		</location>
		<location id="id54" x="807" y="-246">
			<committed/>
		</location>
		<location id="id55" x="807" y="-306">
			<name x="797" y="-340">UserReady</name>
		</location>
		<init ref="id55"/>
		<transition>
			<source ref="id55"/>
			<target ref="id54"/>
			<label kind="guard" x="816" y="-297">BagsOnFeed[0] + BagsOnFeed[1]==0</label>
			<label kind="synchronisation" x="816" y="-280">Init!</label>
		</transition>
		<transition>
			<source ref="id53"/>
			<target ref="id55"/>
			<nail x="1011" y="-298"/>
		</transition>
		<transition>
			<source ref="id52"/>
			<target ref="id55"/>
			<nail x="603" y="-298"/>
		</transition>
		<transition>
			<source ref="id54"/>
			<target ref="id51"/>
			<label kind="synchronisation" x="722" y="-212">colorT!</label>
			<nail x="773" y="-187"/>
		</transition>
		<transition>
			<source ref="id54"/>
			<target ref="id51"/>
			<label kind="synchronisation" x="849" y="-212">colorF!</label>
			<nail x="841" y="-187"/>
		</transition>
		<transition>
			<source ref="id51"/>
			<target ref="id53"/>
			<label kind="guard" x="824" y="-127">false and BagsOnFeed[1]==0</label>
			<label kind="synchronisation" x="875" y="-161">checkin1!</label>
		</transition>
		<transition>
			<source ref="id51"/>
			<target ref="id52"/>
			<label kind="guard" x="646" y="-136">BagsOnFeed[0]==0</label>
			<label kind="synchronisation" x="671" y="-161">checkin0!</label>
		</transition>
	</template>
	<template>
		<name>User_two</name>
		<location id="id56" x="-34" y="-136">
			<name x="-44" y="-170">BagCreated</name>
			<committed/>
		</location>
		<location id="id57" x="-238" y="-136">
			<name x="-306" y="-170">FeedBelt0</name>
			<committed/>
		</location>
		<location id="id58" x="170" y="-136">
			<name x="178" y="-161">FeedBelt1</name>
			<committed/>
		</location>
		<location id="id59" x="-34" y="-246">
			<committed/>
		</location>
		<location id="id60" x="-34" y="-306">
			<name x="-44" y="-340">UserReady</name>
		</location>
		<init ref="id60"/>
		<transition>
			<source ref="id60"/>
			<target ref="id59"/>
			<label kind="synchronisation" x="-25" y="-289">Init!</label>
		</transition>
		<transition>
			<source ref="id58"/>
			<target ref="id60"/>
			<nail x="170" y="-298"/>
		</transition>
		<transition>
			<source ref="id57"/>
			<target ref="id60"/>
			<nail x="-238" y="-298"/>
		</transition>
		<transition>
			<source ref="id59"/>
			<target ref="id56"/>
			<label kind="synchronisation" x="-119" y="-212">colorT!</label>
			<nail x="-68" y="-187"/>
		</transition>
		<transition>
			<source ref="id59"/>
			<target ref="id56"/>
			<label kind="synchronisation" x="8" y="-212">colorF!</label>
			<nail x="0" y="-187"/>
		</transition>
		<transition>
			<source ref="id56"/>
			<target ref="id58"/>
			<label kind="guard" x="8" y="-136">BagsOnFeed[1]==0</label>
			<label kind="synchronisation" x="34" y="-161">checkin1!</label>
		</transition>
		<transition>
			<source ref="id56"/>
			<target ref="id57"/>
			<label kind="guard" x="-195" y="-136">BagsOnFeed[0]==0</label>
			<label kind="synchronisation" x="-170" y="-161">checkin0!</label>
		</transition>
	</template>
	<system>// Place template instantiations here.

// Bag1 = Bag2();
// FeedBelt0 = FeedBelt_motor(0);
// FeedBelt1 = FeedBelt_motor(1);

FeedBelt_Controller0 = FeedBelt_Controller(0);
FeedBelt_Controller1 = FeedBelt_Controller(1);
T0 = Template0(0);
T1 = Template0(1);

// List one or more processes to be composed into a system.
//system Controller, FeedBelt0, FeedBelt1, DisBelt_motor, User, Bag;
//system FeedBelt_Control1er10 FeedBelt_Control1er1=,0, FeedBelt1, DisBelt_motor, User, Bag;
system FeedBelt_Controller0, FeedBelt_Controller1, DisBelt_motor, User, Bag, T1, T0;
</system>
	<queries>
		<query>
			<formula>A[] not deadlock</formula>
			<comment>deadlock check </comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(0).Destination_A</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(0).Destination_B</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(0).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(1).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; forall(i:t_id) Bag(i).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[](Bag(1).Destination_A imply (Bag(1).x_bag &gt;=74 and Bag(1).x_bag &lt;=79))</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[](Bag(1).Destination_A imply (Bag(1).x_bag &gt;=74 and Bag(1).x_bag &lt;=133))</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[](not (Bag(1).fb0_stopped or Bag(1).fb1_stopped) imply (Bag(1).Destination_A imply (Bag(1).x_bag &gt;=74 and Bag(1).x_bag &lt;=79)))</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[] (Bag(0).Destination_A imply Bag(0).x_bag &gt;=74)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; (Bag(1).Destination_A and Bag(1).x &gt;=79)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt;(Bag(1).Destination_A || Bag(1).Destination_B )</formula>
			<comment>not finished</comment>
		</query>
		<query>
			<formula>Bag(0).Destination_A --&gt; Bag(0).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>Bag(0).color== YELLOW --&gt; Bag(0).Destination_B</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[] ((Bag(0).color == YELLOW) imply A&lt;&gt; Bag(0).Destination_B)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>A&lt;&gt; (collision[0] &lt;= 1 and collision[1] &lt;= 1)</formula>
			<comment>for all the paths, there will be no collition in the critical area collision zero or one</comment>
		</query>
		<query>
			<formula>Bag(0).Initalized --&gt; Bag(0).Finish</formula>
			<comment>All the bags in destination A will arrive to state finish</comment>
		</query>
		<query>
			<formula>--&gt;</formula>
			<comment>leads to </comment>
		</query>
		<query>
			<formula>A[] Bag(0).Destination_A imply Bag(0).color == BLACK
</formula>
			<comment>For all the execution paths, the bag zero in destination A have a the black color.</comment>
		</query>
		<query>
			<formula>A[] Bag(1).Destination_A imply Bag(1).color == BLACK
</formula>
			<comment>For all the execution paths, the bag one in destination A have a the black color.</comment>
		</query>
		<query>
			<formula>A[] (Bag(1).Destination_A imply Bag(1).color == BLACK) and (Bag(1).Destination_B imply Bag(1).color == YELLOW) 
</formula>
			<comment>For all the execution paths, the bag one in destination A have a the black color. In the other case that the same bag in in destination B then in have the color yellow. </comment>
		</query>
		<query>
			<formula>A&lt;&gt; (Bag(0).Destination_A or Bag(0).Destination_B)</formula>
			<comment>There exists a path where bag zero gets to either destination A or destination B</comment>
		</query>
		<query>
			<formula>E&lt;&gt;(Bag(0).Initalized) --&gt; (Bag(0).Destination_A or Bag(0).Destination_B) </formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; (Bag(1).Destination_A or Bag(1).Destination_B)</formula>
			<comment>There exists a path where bag one gets to either destination A or destination B</comment>
		</query>
		<query>
			<formula>E&lt;&gt; forall(i:t_id)(Bag(i).Destination_A or Bag(i).Destination_B)</formula>
			<comment>There exists a path where all the bags in the sysyem gets to either destination A or destination B</comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(1).Destination_B</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(0).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; Bag(1).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; forall(i:t_id) Bag(i).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt;(Bag(1).Destination_A and Bag(1).x &lt;82)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; (Bag(0).Destination_A and Bag(1).x &gt;=79)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; (Bag(1).Destination_A and Bag(1).x &gt;=79)</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; (Bag(1).Destination_A || Bag(1).Destination_B )</formula>
			<comment></comment>
		</query>
		<query>
			<formula>Bag(0).Destination_A --&gt; Bag(0).Finish</formula>
			<comment></comment>
		</query>
		<query>
			<formula>forall(i:t_id) Bag(i).</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt;  Bag(1).Initalized --&gt; (Bag(1).Destination_A || Bag(1).Destination_B )</formula>
			<comment></comment>
		</query>
	</queries>
</nta>
